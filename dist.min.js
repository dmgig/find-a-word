var lineMath=function(e,t){function a(e,t){return e[0]==t[0]?null:(t[1]-e[1])/(t[0]-e[0])}function o(e,t){return console.log(e),console.log(t),null===t?e[0]:e[1]-t*e[0]}e=[Number(e[0]),Number(e[1])],t=[Number(t[0]),Number(t[1])],console.log(e),console.log(t);var r=a(e,t),s=o(e,r),n=!1;if(e[0]>t[0]||e[1]>t[1]){var i,d;n=!0,d=[e[0],e[1]],i=[t[0],t[1]],e=i,t=d}var l,c=[];if(e[0]!=t[0])if(e[0]<t[0])for(x=e[0];x<=t[0];x++)l=r*x+s,c.push([x,l]);else for(x=e[0];x>=t[0];x--)l=r*x+s,c.push([x,l]);else for(l=e[1];l<=t[1];l++)c.push([e[0],l]);return n&&c.reverse(),c},data={testgame:{wordlist:["COW","CAT","DOG","PIG","OWL"],gameboard:[["G","O","D","X","X","X"],["X","X","X","X","O","X"],["X","X","C","O","W","X"],["C","X","X","X","L","G"],["X","A","X","X","I","X"],["X","X","T","P","X","X"]]},gameone:{wordlist:["ANNAPOLIS","AUGUSTA","AUSTIN","BISMARCK","CHARLESTON","CHEYENNE","COLUMBUS","HARRISBURG","HARTFORD","LANSING","MADISON","MONTGOMERY","NASHVILLE","OLYMPIA","PROVIDENCE","RICHMOND","SACRAMENTO","SALEM","SPRINGFIELD","TALLAHASSEE"],gameboard:[["D","E","S","P","J","H","I","C","V","A","G","G","O","K","L","W","M"],["H","L","V","Q","F","A","I","P","M","Y","L","O","X","B","U","O","M"],["F","L","E","S","P","T","F","Z","G","C","H","E","Y","E","N","N","E"],["X","I","Z","I","Z","S","A","C","R","A","M","E","N","T","O","N","L"],["J","V","Q","L","F","U","Y","S","U","I","T","B","G","N","S","N","A"],["J","H","U","O","T","G","I","T","B","Q","C","O","I","K","A","H","S"],["D","S","B","P","H","U","N","A","S","A","M","H","Q","P","T","Z","D"],["B","A","H","A","L","A","S","I","I","E","U","D","M","R","V","E","Q"],["U","N","A","N","Y","C","H","A","R","L","E","S","T","O","N","J","K"],["Q","L","R","N","C","O","V","Y","R","P","V","Q","T","V","N","Q","G"],["P","O","T","A","L","L","A","H","A","S","S","E","E","I","F","D","K"],["P","D","F","Y","I","U","B","P","H","O","Z","R","Y","D","N","Q","K"],["O","T","O","T","T","M","A","D","I","S","O","N","W","E","E","Q","Y"],["Y","F","R","A","L","B","W","P","L","A","N","S","I","N","G","Q","M"],["B","F","D","O","O","U","M","B","I","S","M","A","R","C","K","C","Q"],["R","N","H","H","B","S","Q","M","N","F","P","G","G","E","D","Z","E"],["R","O","P","R","G","Y","P","O","L","F","K","K","G","B","I","N","O"]]},gametwo:{wordlist:["ANNAPOLIS","AUGUSTA","AUSTIN","BISMARCK","CHARLESTON","CHEYENNE","COLUMBUS","HARRISBURG","HARTFORD","LANSING","MADISON","MONTGOMERY","NASHVILLE","OLYMPIA","PROVIDENCE","RICHMOND","SACRAMENTO","SALEM","SPRINGFIELD","TALLAHASSEE"],gameboard:[["V","Q","I","T","A","L","L","A","H","A","S","S","E","E","H","E","Q"],["N","I","X","Z","M","A","N","H","E","G","I","U","K","P","A","R","J"],["Q","A","R","Q","R","R","N","T","M","B","F","L","L","G","R","A","O"],["Z","I","I","I","Z","X","J","L","J","W","K","Q","R","D","R","C","J"],["P","H","A","R","S","F","V","R","L","B","J","C","L","N","I","W","C"],["A","F","V","K","X","K","T","M","K","Y","I","I","L","O","S","W","C"],["E","C","V","J","Y","N","X","I","W","Q","Y","I","P","J","B","M","Y"],["K","E","C","I","T","H","X","L","W","T","M","E","L","C","U","K","N"],["M","E","H","Y","V","Y","V","A","S","C","C","C","D","C","R","L","J"],["W","T","E","G","D","C","O","Q","T","G","G","J","J","G","G","D","G"],["D","V","Y","C","Q","T","F","N","Z","D","Y","A","S","D","J","E","O"],["N","X","E","V","D","N","Z","K","Y","L","L","X","S","G","I","M","V"],["P","K","N","C","O","Q","N","O","K","H","G","W","F","H","M","U","A"],["I","I","N","A","E","I","R","V","J","L","C","T","H","Q","O","B","G"],["H","F","E","O","R","I","U","E","Z","C","U","O","U","X","U","I","H"],["A","S","A","Z","V","X","Y","C","M","I","L","H","P","A","V","C","Q"],["U","Z","V","J","D","O","K","U","N","N","E","V","W","Q","V","Z","A"]]}}(function(e,t){"use strict";e=e.testgame;var a={state:"ready",init:function(){console.log("init"),a.controls.create(),a.resultsboard.create(),a.wordlist.create(),a.gameboard.create(),a.canvas.create()},controls:{create:function(){this.enableResign(),$("#reset").off().on("click",a.controls.reset),$("#resign").off().on("click",a.controls.resign)},reset:function(){function e(){a.state="ready",a.wordlist.reset(),$("#wordlist-subcontainer").empty(),$("#gameboard-subcontainer").empty(),$("#results-container").empty(),a.init()}if(console.log("reset"),"resigned"==a.state||"completed"==a.state)return void e();var t=confirm("You want to reset the game? All found words will be erased.");t===!0&&e()},resign:function(){console.log("resign");var e=confirm("You want to resign the game?");e===!0&&(a.state="resigned",a.resultsboard.indicateResigned(),a.gameboard.lock())},gameCompleted:function(){console.log("game-completed")},enableResign:function(){$("#resign").css("visibility","visible")},disableResign:function(){$("#resign").css("visibility","hidden")}},resultsboard:{create:function(){console.log("create results board");var e=$("<div></div>").attr("id","results");$("#results-container").append(e),this.clear()},update:function(e){$("#results").html(e)},indicateComplete:function(){a.gameboard.lock(),this.update("You found all the words on this puzzle."),a.state="completed",a.controls.disableResign(),$("#results").addClass("completed")},indicateResigned:function(){var e=a.wordlist.words.length,t=a.wordlist.found.length,o=t+" of "+e;this.update("You resigned. You found "+o+" words."),$("#results").addClass("resigned")},clear:function(){$("#results").removeClass(),this.update("Ready to Play!")}},wordlist:{words:e.wordlist,found:[],create:function(){var t=$("<ul></ul>").attr("id","wordlist");$("#wordlist-subcontainer").append(t);for(var a in e.wordlist){var o=$("<li>"+e.wordlist[a]+"</li>").addClass("word");t.append(o)}},isInList:function(e){var t=this.words.indexOf(e);return t!=-1&&(this.found.push(e),!0)},crossOffList:function(e){$("li.word").each(function(t,a){$(a).text()==e&&$(a).html("<strike>"+e+"</strike>")})},isGameCompleted:function(){return this.words.length==this.found.length},reset:function(){this.found=[]}},gameboard:{state:"startup",selected_a:[],selected_b:[],create:function(){function t(e,t,o){return $("<td>"+o+"</td>").data("x",e).data("y",t).on("mousedown",a.gameboard.selectA).on("mouseup",a.gameboard.selectB).on("mouseenter",a.gameboard.isInLine).on("mouseleave",a.gameboard.clearInLine)}this.state="waiting";var o=$("<table></table>").attr("id","gameboard");$("#gameboard-subcontainer").append(o);for(var r in e.gameboard){o.append("<tr></tr>");for(var s in e.gameboard[r]){var n=e.gameboard[r][s],i=t(s,r,n);o.find("tr:eq("+r+")").append(i)}}$("#gameboard").on("mouseleave",a.gameboard.resetBoard),$("#gameboard-subcontainer").css("height",$("#gameboard").height()+"px").css("width",$("#gameboard").width()+"px")},selectA:function(){var e=$(this);e.addClass("selectA"),a.gameboard.state="selectA",a.gameboard.selected_a=[e.data("x"),e.data("y")]},selectB:function(){var e=$(this);if(e.hasClass("outofline")||e.hasClass("selectA"))return void a.gameboard.resetBoard();a.gameboard.state="selectB",a.gameboard.selected_b=[e.data("x"),e.data("y")];var t=a.gameboard.checkWord();t?(a.gameboard.state="waiting",a.wordlist.isGameCompleted()&&a.resultsboard.indicateComplete(),a.gameboard.resetBoard()):a.gameboard.state="waiting"},isInLine:function(){var e=a.gameboard.state;if("waiting"!=e){var t=a.gameboard.selected_a,o=[$(this).data("x"),$(this).data("y")];t[0]==o[0]||t[1]==o[1]||Math.abs(t[0]-o[0])==Math.abs(t[1]-o[1])?a.gameboard.highlightDraggedSelection(t,o):$(this).addClass("outofline")}},clearInLine:function(){a.gameboard.clearDraggedSelection(),$(this).removeClass("outofline")},checkWord:function(){var e=a.gameboard.selected_a,t=a.gameboard.selected_b,o=this.getWord(e,t);return a.gameboard.clearDraggedSelection(),a.wordlist.isInList(o)?(console.log("found a word"),a.canvas.circleWord(e,t),a.wordlist.crossOffList(o),!0):(console.log(o+" is not a word on the list."),a.gameboard.resetBoard(),!1)},getWord:function(e,a){var o=[],r=t(e,a);for(var s in r){var n=r[s],i=$("tr:eq("+n[1]+") td:eq("+n[0]+")").text();o.push(i)}var d=o.join("");return d},highlightDraggedSelection:function(e,a){var o=t(e,a);for(var r in o){var s=o[r];$("tr:eq("+s[1]+") td:eq("+s[0]+")").addClass("dragged-selection")}},clearDraggedSelection:function(){$("td").removeClass("dragged-selection")},resetBoard:function(){console.log("resetBoard"),$("td").removeClass(),a.gameboard.clearDraggedSelection(),a.gameboard.state="waiting"},lock:function(){this.resetBoard(),$("td").off()}},canvas:{create:function(){var e=$("<canvas></canvas>").attr("id","gamecanvas");$("#gameboard-subcontainer").append(e);var t=$("#gameboard").position().top,a=$("#gameboard").css("margin","0 auto"),o=$("#gameboard").height()-2,r=$("#gameboard").width()-2;$("#gamecanvas").css("top",t+"px").css("left",a+"px").css("width",r+"px").css("height",o+"px").attr("width",r).attr("height",o)},circleWord:function(e,t){function a(e){return 26*e+13}console.log("circleword"),console.log(e,t),e=[a(e[0]),a(e[1])],t=[a(t[0]),a(t[1])];var o=document.getElementById("gamecanvas"),r=o.getContext("2d");r.beginPath(),r.lineCap="round",r.lineWidth=20,r.strokeStyle=this.rainbow(20,Math.floor(20*Math.random())+1),r.moveTo(e[0],e[1]),r.lineTo(t[0],t[1]),r.stroke()},rainbow:function(e,t){var a,o,r,s=t/e,n=~~(6*s),i=6*s-n,d=1-i;switch(n%6){case 0:a=1,o=i,r=0;break;case 1:a=d,o=1,r=0;break;case 2:a=0,o=1,r=i;break;case 3:a=0,o=d,r=1;break;case 4:a=i,o=0,r=1;break;case 5:a=1,o=0,r=d}var l="#"+("00"+(~~(255*a)).toString(16)).slice(-2)+("00"+(~~(255*o)).toString(16)).slice(-2)+("00"+(~~(255*r)).toString(16)).slice(-2);return l},clear:function(){$("#gamecanvas").remove(),this.create()}}};a.init()})(data,lineMath);